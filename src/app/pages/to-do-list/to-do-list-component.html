<div class="row">
    <div class="col-12">
        <div class="mg-page-title">
            <h3>Todo List</h3> 
        </div>   
    </div>
</div>

<div class="row">
	<div class="col-6">
        <div class="card border-grey mb-3">
            <div class="card-header text-center fw-bold">Ajouter une tâche</div>
            <div class="card-body text-center">
                <form [formGroup]="todoForm" (ngSubmit)="onSubmit()" autocomplete="off">
                    <div class="row mb-3">
                        <label for="description" class="col-sm-3 col-form-label">Description <span class="text-danger">*</span></label>
                        <div class="col-sm-7">
                            <input type="text" 
                                   class="form-control"
                                   id="description"
                                   formControlName="description"
                                   maxlength="30"
                                   #descriptionItem>  
                        </div>
                        <div class="col-sm-2">
                        </div>
                    </div>              
                    <div class="row mb-3">
                        <div class="col-sm-4">
                            <button type="submit" [disabled]="todoForm.invalid" [class]="todoForm.invalid ? 'btn btn-outline-secondary btn-sm rounded-pill' : 'btn btn-outline-success btn-sm rounded-pill'">Ajouter</button>
                            &nbsp;
                            <button type="reset" class="btn btn-sm btn-outline-warning rounded-pill" (click)="onReset()">Effacer</button>            
                        </div>
                        <div class="col-sm-8 text-start">
                            @if(showErrorMessage('description', 'required')){
                                <div class="invalid-feedback d-block">
                                    La description est obligatoire
                                </div>
                            }
                            @if(showErrorMessage('description', 'maxlength')){
                              <div class="invalid-feedback d-block">
                                  Maximum 20 caractères
                              </div>
                            }
                            @if(showErrorMessage('description', 'pattern')){
                              <div class="invalid-feedback d-block">
                                  Saisie incorrecte
                              </div>
                            }
                        </div>
                    </div>
                </form>
            </div>
        </div>
	</div>
	<div class="col-6">
	</div>
</div>

<div style="color:red">Corriger bouton supprimer  avec changement filtre et status - KO</div>

<div class="row mg-top-20">
    <div class="col-12">
        <div class="fw-bold text-decoration-underline">Filtre:</div>
        <div class="form-check form-check-inline">
        <input class="form-check-input" type="radio" #statusFiltersOptions name="statusFilters" id="status1" value="option1" (change)="onStatusFilterChange($event)">
        <label class="form-check-label" for="status1">En cours</label>
        </div>
        <div class="form-check form-check-inline">
        <input class="form-check-input" type="radio" #statusFiltersOptions name="statusFilters" id="status2" value="option2" (change)="onStatusFilterChange($event)">
        <label class="form-check-label" for="status2">Terminée</label>
        </div>
        <div class="form-check form-check-inline">
        <input class="form-check-input" type="radio" #statusFiltersOptions name="statusFilters" id="status3" value="option3" (change)="onStatusFilterChange($event)" checked>
        <label class="form-check-label" for="status3">Tout</label>
        </div>
    </div>
</div>

@if (todoList() && todoList().length > 0) {
    <div class="row mg-top-20">
        <div class="col-6">
            <table class="table table-striped">
                <thead>
                    <tr>
                        <th scope="col">N°</th>
                        <th scope="col">Description</th>
                        <th scope="col">Terminée</th>
                        <th scope="col"></th>
                    </tr>
                </thead>
                <tbody>
                    @for (item of todoList(); track item.id) {
                        <tr>
                            <td>{{ item.id }}</td>
                            <td>{{ item.description }}</td>
                            <td>
                                <input 
                                    class="form-check-input"
                                    type="checkbox"
                                    [name]="'task-' + item.id"
                                    [id]="'task-' + item.id"
                                    [checked]="item.done"
                                    (change)="changeTodoItemStatus(item.id, $event)">
                            </td>
                            <td>
                                <button type="button"
                                        class="btn btn-outline-danger btn-sm"
                                        (click)="removeTodoItem(item.id)">Supprimer</button>
                            </td>
                        </tr>
                    }    
                </tbody>
                <tfoot>
                    <tr>
                        <td colspan="4" style="text-align: center">
                            <button type="button"
                                    class="btn btn-outline-danger btn-sm"
                                    (click)="clearTodoList()">Vider la liste</button>
                        </td>
                    </tr>
                </tfoot>
            </table>
        </div>
        <div class="col-6">
            <!-- <pre>
                {{ todoList() | json }}
            </pre>    -->
        </div>
    </div>
}







<!-- 
<div style="max-width: 30%">
    <input type="text" class="form-control" #descriptionToAdd required>

    <button type="button" 
        class="btn btn-warning btn-sm rounded-pill"
        (click)="addItem(descriptionToAdd.value)">Ajouter</button>
</div> -->



<!-- <div>
    @for (item of toDoList(); track item) {
        <div>{{ item.description }}</div>
    }
</div> -->